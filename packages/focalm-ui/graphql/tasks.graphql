fragment FullTask on Task {
    id

    state
    title
    archived

    createdAt
    updatedAt

    dueToDate
    dueToOffset
    startAfterDate
    startAfterOffset
    plannedStartDate
    plannedStartOffset

    impact
    ease

    orderKey

    parent {
        id
        title
    }
    responsibleId
    authorId
    participants {
        userId
        tags {
            tag
        }
    }
}

fragment BriefUser on User {
    id
    email
    name
}

query GetTasks($updatedAfter: DateTime) {
    tasks(updatedAfter: $updatedAfter) {
        tasks {
            ...FullTask
        }
        relatedUsers {
            ...BriefUser
        }
    }
}

mutation UpdateTasks($changes: [TasksChangesGroup!]!, $updatedAfter: DateTime) {
    result: updateTasks(changes: $changes) {
        changedIds {
            src
            dst
        }
        tasks(updatedAfter: $updatedAfter) {
            tasks {
                ...FullTask
            }
            relatedUsers {
                ...BriefUser
            }
        }
    }
}
