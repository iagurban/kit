fragment FullTask on Task {
    id

    state
    title
    description
    archived

    createdAt
    updatedAt

    dueToDate
    dueToOffset
    startAfterDate
    startAfterOffset
    plannedStartDate
    plannedStartOffset

    impact
    ease

    orderKey

    parent {
        id
        title
    }
    responsibleId
    authorId
    projectId
    participants {
        userId
        tags {
            role {
                id
                name
                color
            }
        }
    }

    relationsSrc {
        dstId
        typeId
    }
    relationsDst {
        srcId
        typeId
    }
}

fragment BriefUser on User {
    id
    email
    name
    abbrev
}

query GetTasks($updatedAfter: DateTime) {
    tasks(updatedAfter: $updatedAfter) {
        tasks {
            ...FullTask
        }
        relatedUsers {
            ...BriefUser
        }
    }
}


query SearchTasks($titleLike: String) {
    searchTasks(titleLike: $titleLike) {
        tasks {
            id
            title
            state
        }
    }
}

mutation UpdateTasks($changes: [TasksChangesGroup!]!, $updatedAfter: DateTime) {
    result: updateTasks(changes: $changes) {
        changedIds {
            src
            dst
        }
        tasks(updatedAfter: $updatedAfter) {
            tasks {
                ...FullTask
            }
            relatedUsers {
                ...BriefUser
            }
        }
    }
}


query GetParticipantsRoles {
    participantsRoles {
        id
        name
        color
    }
}

query GetUsers {
    users {
        id
        email
        name
        abbrev
    }
}

query GetProject($id: String) {
    project(id: $id) {
        id
        name
        relationTypes {
            id
            forward
            inverse
        }
    }
}

query GetProjects {
    projects {
        id
        name
        relationTypes {
            id
            forward
            inverse
        }
        ownOf {
            id
        }
    }
}

query GetFailingQuery {
    failingQuery
}
